---
layout: post
title:  "¿Qué vería a través un agujero de gusano?"
date:   2021-01-19 10:00:00 +0100
tags: wormhole "ray tracing"
categories: "ray tracing"
published: false
---

La ciencia ficción siempre ha fantaseado con la idea de viajar distancias imposibles utilizando instrumentos que alteren las propiedades del espacio a su aldedor. Este es el caso de la serie de videojuegos Portal, en la que el protagonista se vale del "Aperture Science Handheld Portal Device" para crear portales que conectan puntos del espacio de otra forma desconectados. Si bien en el juego se refieren a este tipo de estructuras como "portales", su nombre real tanto en el mundo académico como en la cultura popular es el de "agujeros de gusano" desde que Charles Misner y John A. Wheeler acuñaran este término en 1957 {% cite Misner1957 %}. Aquí, se referían a los agujeros de gusano como puntos que conectarían regiones del espacio y del tiempo por medio de intensas deformaciones en el tejido espacio-temporal. Sin embargo, no fue hasta 2014 en la película Interstellar, cuando se le presentó al público una imagen de un agujero de gusano que pretendía ser exacta y acorde con las leyes físicas que conocemos hasta ahora {% cite James2015 %}. Se debe aclarar, no obstante, que nunca se ha divisado un agujero de gusano debido tanto a las dificultades técnias que esto conllevaría {% cite Dai2019 %} como a la incertidumbre que existe actualmente en torno a su (no) existencia. La existencia de agujeros de gusano requeriría tanto la posibilidad de aparición de energía negativa como de curvas cerradas de tipo tiempo (es decir, de viajes en el tiempo) {% cite Friedman2008 %}. Además, de existir, muy probablemente este tipo de constructos se cerraría casi inmediatamente tras aparecer, por lo que la posibilidad de viajar a través de ellos sería limitada, más aún teniendo en cuenta que no sería un viaje cómodo debido a las intensas fuerzas de compresión y extensión a las que estaría sometido nuestro cuerpo al atravesar una región del espacio tiempo con una curvatura semejante. Aun con todo, ¿a quién no le produciría al menos una pizca de curiosidad el mirar a través de uno de ellos desde la comodidad de su sofá?

Las formas de representar un agujero de gusano son muy variadas, empezando por [las más artísticas](https://www.nasa.gov/centers/glenn/images/content/101681main_CD1998_76634_1200x900.jpg){:target="_blank"}, pasando por modelos confeccionados con la ayuda de programas de CGI (_Computer Generated Imagery_) hasta las simulaciones más precisas como son las que podemos encontrar en la película. En este post trataré de explicar cómo podemos conseguir replicar el agujero de gusano que aparece en la película Interstellar, e intentaré hacerlo sin mostrar ecuaciones ni código (ya están los _papers_ y GitHub para eso) y partiendo de la base de la que partía yo cuando acometí este proyecto hace poco más de un mes: sin saber nada sobre el tema más allá de las ideas generales. Es importante recalcar la extrema complejidad de todo lo que voy a tratar aquí, por lo que simplificaré algunos detalles que no tendrán impacto en el conjunto, pero sí serán importantes a la hora de adquirir un conocimiento en profundidad de los temas que voy a tocar. En los siguientes apartados explicaré los fundamentos de la técnica de trazado de rayos (_Ray Tracing_) que utilizaremos para la simulación, cómo aplicarla al espacio curvo y los pasos que hay que seguir hasta dar con la imagen final. En la Figura 1 se muestra el resultado que he obtenido. 


![Agujero de gusano](/blog/assets/2.wormhole/images/result.png){: width="850px" class="image-centered"}
*Figura 1: Representación del agujero de gusano que se ha obtenido siguiendo el método que se describe en este post.*

### Tracemos unos rayos

Cuando miramos un objeto, ¿qué es lo que vemos? Esa es la pregunta fundamental que debemos hacernos antes de empezar con este proyecto, puesto que de su respuesta dependerá el enfoque que le demos. Cuando miramos un objeto nuestro cerebro está registrando la intensidad de luz que portan los rayos que chocan contra los receptores de nuestra retina. Estos rayos proceden de las fuentes de luz que tenemos en nuestro entorno y adquieren una intensidad u otra en función de los objetos contra los que impactan. Así, cuando estamos al aire libre y vemos una manzana de color rojo es porque algunos rayos procedentes del sol han chocado contra ella y ésta nos ha devuelto la parte roja de los mismos. Una cámara se vale de un principio muy similar para capturar una fotografía: en el cuerpo de la cámara se encuentra el sensor, organizado en píxeles formando una cuadrícula, y cada uno de estos píxeles registra la intensidad de la luz que choca contra él. Este mismo principio se aplica para generar imágenes por ordenador, se colocan en la escena los elementos principales (cámara, luces y objetos) y en un proceso denominado _renderizado_ se traza la trayectoria de los rayos que impactan contra la cámara atendiendo además a sus rebotes y refracciones a los que éstos son sometidos. Esta técnica se denomina "Ray Tracing" y es fundamental en los procesos de renderizado modernos[^1].

El trazado de rayos comienza colocando la cámara en un punto de la escena y ¿recuerdas que una cámara tiene un sensor que forma una cuadrícula y es ahí donde se proyecta la imagen? Utilizaremos este mismo concepto. A una distancia de la cámara (la llamaremos distancia focal) colocaremos el plano de la pantalla, como en la Figura 2 <!-- HAY QUE PONER UNA FIGURA CON LA PANTALLA -->. Será en este plano donde se formará la imagen. Evidentemente no podremos saber a priori qué rayos llegarán a cada píxel de la pantalla, y trazar todos los rayos posibles desde la fuente de luz parece una estrategia abocada al fracaso puesto que la mayoría ni siquiera rozarán la pantalla. No obstante, podemos valernos de que el comportamiento de los rayos es determinista y trazarlos al revés, desde la cámara hacia la escena, haciéndolos rebotar con los objetos y hasta que confluyan en una fuente de luz o se pierdan en el infinito mar de rebotes y refracciones. Con cada choque el valor de la intensidad del rayo de luz cambiará en función de los parámetros del objeto (no es lo mismo una bola de cristal transparente que un cubo de madera de color marrón). Es importante señalar que en escenas cotidianas estos rayos se moverán en línea recta entre choques, de ninguna forma curvarán sus trayectorias (así es como se comporta la luz, generalmente viaja en línea recta), por lo que será inmediato saber para cada momento de tiempo dónde se encuentra un rayo de luz. Este será uno de los puntos a tener en cuenta al introducir el agujero de gusano.

<!-- FIGURA DE LA PANTALLA -->

No merece la pena entrar en el detalle de cómo calcular la dirección de un rayo después de un rebote ni su intensidad, pero dejo aquí un libro que me ha sido de mucha ayuda en mi todavía corto viaje por el Ray Tracing: [_Ray Tracing in One Weekend_](https://raytracing.github.io/books/RayTracingInOneWeekend.html){% cite Shirley2020 %}.

### Diseñando un agujero de gusano

Existen multitud de formas diferentes de diseñar un agujero de guano tal que sea físicamente plausible[^2]. La primera vez que se consiguió fue en 1973, cuando H. G. Ellis{% cite Ellis1973 %} y K. A. Bronnikov{% cite Bronnikov1973 %} (por separado) desarrollaron un modelo matemático del agujero de gusano tal y como lo conocemos ahora, en el que en principio podría existir traspaso de materia entre los dos lados del mismo. Este agujero en realidad atraía intensanmente a la materia hacia su garganta (el centro del agujero) por uno de sus extremos, mientras que la repulsión del otro extremo era igualmente intensa. Por este motivo, se le denominó _Ellis drainhole_ (_drain_ significa desagüe en inglés y _hole_ es agujero). 

<!-- Aquí una foto del agujero de gusano de Ellis  -->

Si bien en los años siguientes se desarrollaron otros agujeros de gusano con características variopintas (incluso algunos que permitirían viajar en el tiempo{% cite Morris1988 %}), debido a su simplicidad matemática trabajaremos con una versión ligeramente modificada del agujero de gusano de Ellis para generar nuestra imagen. ¿Por qué una versión modificada? La razón es muy sencilla: al parecer Christopher Nolan (el director de la película) quería tener control sobre la forma del agujero -el radio de la garganta y la distancia entre los extremos principalmente- y eso es algo que el agujero de gusano de Ellis no ofrece, así que desarrollaron una modificación para la película{% cite James2015 %}. El estudio de animación que se encargó de todo esto se llama [DNEG](https://www.dneg.com/) así que (oh, sorpresa) bautizaron a su agujero de gusano... Dneg.

<!-- Aquí una foto del agujero de gusano que vamos a utilizar -->

Como parámetros para nuestro agujero utilizaremos un radio de la garganta (\\( \rho \\)) de 1km, una altura de la garganta (\\( a \\)) de 0.01km y situaremos la cámara a 6.25km de la boca superior del agujero (en la posición de la Figura anterior), apuntando directamente a la boca del mismo. Como sabemos, se unirán dos partes diferentes del universo, cada una con su [esfera celeste](https://es.wikipedia.org/wiki/Esfera_celeste) (sí, así se llama a la esfera alrededor del observador en la que se colocan los astros), así que la cámara estará rodeada por un cielo estrellado y apuntará hacia el planeta Saturno, que se encontrará al otro lado del agujero[^3]. Las imágenes están disponibles en el [material suplementario del paper](https://www.dneg.com/interstellar-wormhole/). Para imaginarlo -aunque no sea físicamente correcto-, podemos pensar en el agujero de la figura anterior con una esfera hueca a cada lado de la garganta en cuyo interior pegaremos una imagen con el contenido de esa porción del universo, esas serán las dos esferas celestes. Con esto ya tenemos todos los ingredientes necesarios para empezar a tomar nuestra foto.


### Agárrate, que vienen curvas

Ya hemos visto cómo tratar con los rayos que se mueven por el espacio plano al que estamos acostumbrados (espacio euclídeo). Sin embargo, la propia definición de agujero de gusano implica una deformación del espacio, curvándolo y afectando a todos los objetos que se encuentran a su alrededor, incluidos los rayos de luz. Por este motivo, la trayectoria de los rayos cambiará en función de cómo deforme el espacio el agujero de gusano que diseñemos. No parece necesario ahondar en las ecuaciones porque explicarlas llevaría demasiado tiempo, tan solo es necesario saber que para cada momento en el tiempo podremos obtener la posición exacta en la que se encuentra el rayo. Para el lector interesado, las ecuaciones se encuentran en el apéndice de {% cite James2015 %}. Resolveremos las ecuaciones numéricamente y con ello obtendremos de qué lado del agujero proviene el rayo y en qué punto de la esfera celeste correspondiente. Como hemos visto en el apartado anterior, cada esfera celeste es en realidad una imagen, así que tan solo tendremos que tomar el valor de la imagen en el punto donde ha chocado el rayo, de esta forma tendremos un mapeo entre los píxeles de la cámara (punto inicial de los rayos) y los píxeles de las esferas celestes (punto final de los rayos). En la siguiente Figura se muestra una representación _ficticia_ de este proceso para una de las dos esferas celestes.

<!-- Representación de la cámara -->

Una vez obtenida la imagen podemos pasar a examinarla (Figura 1): vemos que la parte central se corresponde con la esfera celeste que hay en la parte del universo donde no está la cámara (Saturno), mientras que la parte externa es un cielo estrellado. Esto se debe precisamente a la curvatura del espacio. Como los rayos no viajan en línea recta, los píxeles del sensor de la cámara reciben luz desde ambos extremos, por lo que puede ocurrir (y de hecho ocurre) que dos píxeles contiguos reciban luz desde partes muy separadas del universo, de ahí el efecto que se crea


***
[^1]: La técnica de Ray Tracing no es la única actualmente pero sí una de las más utilizadas porque ofrece una buena relación entre la calidad final de las imágenes y el tiempo empleado para renderizar.
[^2]: Que un agujero de gusano sea físicamente plausible implica que es una solución de las ecuaciones de Einstein, no que haya sido observado.
[^3]: Se ha prescindido de colocar la cámara en la Figura LA QUE SEA porque ésta es una representación del agujero en menos dimensiones de las que en realidad toman parte. Está bien para hacerse una idea de cara a la programación colocar la cámara mentalmente en la vertical de la garganta del agujero, apuntando perpendicularmente hacia ésta. Sin embargo, en dicha Figura en realidad se está representando el espacio-tiempo en sí, y todos los objetos deben estar sobre la retícula, incluida la cámara.

***

{% bibliography --cited %}