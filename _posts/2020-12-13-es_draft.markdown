---
layout: post
title:  "¿Puede una IA inventar un idioma?"
date:   2020-11-07 19:39:02 +0100
categories: jekyll update
---

La pregunta que encabeza este post es recurrente en todos los círculos de la Inteligencia Artificial. Aquellos que trabajan en NLP (procesamiento de lenguaje natural por sus siglas en inglés) buscan concebir sistemas que sean capaces de entender (procesar) lenguaje producido por seres humanos y tomar acciones acordes. GPT-3 es un ejemplo de esto, el cometido de este modelo tan solo es predecir (muy acertadamente) la palabra más probable que seguirá una secuencia de texto {% cite Brown2020 %}. Sin embargo, según cómo ha sido entrenado, en ningún caso se puede defender que el modelo posea una comprensión profunda de las palabras que está produciendo ni que tenga un objetivo en particular al expresarlas. Si se me permite mi opinión, creo que el salto que nos queda por delante hasta cubrir este último punto es todavía enorme y no vendrá en los próximos años. Al fin y al cabo, todavía no entendemos cómo funciona la mente humana. 

Si atendemos a la definición de "idioma" en el Diccionario, ésta es "Lengua de un pueblo o nación, o común a varios" {% cite RAE %}, mientras que una de las acepciones de "lengua" es "Sistema de comunicación verbal propio de una comunidad humana y que cuenta generalmente con escritura" {% cite RAEa %}. Cuando hablemos de "idioma" en este post, por lo tanto, nos estaremos refiriendo a un lenguaje común que compartan varios sistemas a través del cual puedan llegar a entenderse y transmitir ideas. No obstante, estas ideas vendrán predefinidas por un agente externo a la IA. Un ejemplo básico podría ser transmitir un número aleatorio de7 0 a 9 del sistema A al B en un lenguaje común, que el B lo procesara, calculara su doble, lo devolviera a A y éste diera con la respuesta correcta. En este post intentaremos sentar las bases de un proyecto que cumpla todos esos requisitos y una condición más: que el idioma que compartan ambos sistemas sea similar al del droide R2-D2 de Star Wars.

### Dos no hablan si uno no quiere

Efectivamente, para que exista comunicación debe haber al menos dos sistemas: un emisor de información (transmisor) y otro receptor de la misma. Siguiendo la Teoría de la Comunicación de Claude E. Shannon {% cite Shannon1948 %}, es necesario además una fuente de información, un canal, un mensaje, un destinatario y un elemento de ruido. Si bien la definición precisa de estos componentes se deja a discreción del lector, es de capital importancia para este proyecto distinguir entre <span style="color:blue">fuente de información</span> y <span style="color:red">transmisor</span>, y <span style="color:blue">destinatario</span> y <span style="color:red">receptor</span>: cuando hablamos de transmisor nos referimos al sistema técnico encargado de _codificar_ la fuente de información a un conjunto de señales aptas para el canal (y viceversa para el receptor, que la _decodifica_ para que el destinatario pueda utilizar la información). Aplicado a la comunicación verbal entre dos personas A y B, la fuente de información será la idea de A, cuyo cerebro se encargará de codificar en forma de palabras (mensaje) que se enviarán por el aire (canal) hasta llegar a B. El cerebro de B decodificará las palabras y generará una idea, que en el mejor de los casos será igual a la idea del cerebro de A.
<!-- Habría que poner una foto aquí de la teoría de información -->

Transformemos ahora esta teoría al campo de la IA. Como sabemos, las redes neuronales son tremendamente eficaces a la hora de generar representaciones a partir de datos, por lo que podríamos enfrentar dos de ellas (sujetos A y B) y hacerlas compartir mensajes. A codificaría el mensaje y B lo... ¿decodificaría? ¿Y qué pasaría si B quisiera transmitir una idea a A? Para encontrar la solución a esta pregunta podemos fijarnos en el sistema más eficiente que conocemos a la hora de producir y procesar lenguaje: el cerebro. Este órgano se encarga de ambas funciones simultáneamente (¿o es que no puedes escuchar música y hablar a la vez?), y eso se debe a que el flujo de información transcurre por zonas separadas[^1]. Estas dos zonas son el área de Wernicke y el área de Broca, que se encargan de la comprensión y de la producción del lenguaje respectivamente {% cite Neil2012 %}. Siguiendo este ejemplo, parece lógico hacer que nuestros sujetos estén formados por dos redes diferentes y desconectadas. Una de estas redes, el _encoder_ se encargará de producir el lenguaje mientras que el _decoder_ tratará de comprenderlo. En caso de que A quiera transmitir una idea a B, será el _encoder_ de A el responsable de transformar esta idea a un lenguaje común y el _decoder_ de B lo interpretará.

<!-- Una figura de la estructura aquí -->

### Hablemos tan claro como R2-D2

Describiré en primer lugar la forma de comunicarse de R2-D2 ara aquellos que la desconozcan. Se trata de una serie de pitidos, silbidos y otros sonidos aglutinados para formar algo que se asemeja a frases {% cite Bray2015 %}. En YouTube hay [infinidad](https://www.youtube.com/watch?v=2-BKjnAgNgY){:target="_blank"} de vídeos mostrando estos sonidos (se abre en otra pestaña). Intentaremos hacer que las redes neuronales imiten este lenguaje a la hora de hablar, forzando que la representación de la idea por parte del _encoder_ sea también una serie de pitidos. Sin embargo, forzar este tipo de representación no es trivial por dos motivos: en primer lugar, el lenguaje debe ser creado espontáneamente a través de la conversación entre las redes, no debe existir ningún tipo de interacción humana en este proceso. En segundo lugar, debemos definir a qué nos referimos con "representación" en este contexto puesto que el lenguaje es muy variado. Abordaremos primero la segunda cuestión, lo que nos llevará inexorablemente hasta la solución de la primera.

Un sonido puede ser representado de tres formas diferentes en función de lo que busquemos conocer acerca del mismo: 
- Representación temporal: muestra la intensidad del sonido en función del tiempo.
- Representación en frecuencias: explicado muy brevemente, todo sonido, por el hecho de ser una onda en función del tiempo, puede ser descompuesto en ondas más básicas con diferentes frecuencias. El método con el que pasamos de una onda en el dominio temporal a una onda en el dominio de frecuencias recibe el nombre de *transformada de Fourier*. La representación en frecuencias contiene información de lo importante (amplitud) que es cada frecuencia para dar lugar al sonido subyacente.
- Representación en forma de espectrograma: las dos representaciones anteriores tienen dos dimensiones, i.e. amplitud en función del tiempo o amplitud de cada frecuencia. Sin embargo, podemos unir ambas para dar lugar a una representación tridimensional: tiempo, amplitud y frecuencia. Un espectrograma muestra la evolución de la frecuencia y de la intensidad en el tiempo. Típicamente, la intensidad se define por el color, mientras que las otras dos dimensiones toman los ejes de abscisas (tiempo) y ordenadas (frecuencia). A diferencia de en los casos anteriores, un espectrograma puede ser guardado en forma de imagen ya que la informaciónm relevante está codificada tanto en el color de los píxeles como en su posición.

<!-- Foto de las tres representaciones -->

Se ha demostrado que las redes neuronales operan bien con datos tabulados y especialmente bien con imágenes {% cite Krizhevsky2012 %}{% cite He2016 %}, así que parece lógico utilizar el espectograma para esta tarea. En general, para trabajar con imágenes se utilizan redes neuronales convolucionales. Explicar en detalle cómo funcionan este tipo de redes daría para otro artículo, por lo que se deja al lector interesado el familiarizarse con este tipo de arquitecturas, ya que existen multitud de recursos disponibles ({% cite DotCSV2020 %}, por ejemplo). Tan solo diré aquí que con una red de capas convolucionales podemos obtener una representación en varias dimensiones de los datos de entrada (una imagen). Es decir, podemos conseguir la traducción de un número cualquiera en una imagen, y esta traducción puede ser aprendida para una tarea concreta. De esta forma, el diagrama anterior adquiere la siguiente estructura:

<!-- Una figura de la estructura aquí con un espectrograma en medio -->

Para hacer que un sistema de redes neuronales se comporte como queremos hay que especificar una cantidad a minimizar. A esta cantidad se le llama _loss_, y en muchos casos es una función que depende de la salida de la red y de los datos originales [^2]. Aplicado a nuestro problema, podemos definir inmediatamente una cantidad que el sistema debe minimizar: queremos que B interprete la misma idea que está intentando de transmitir A. Concretamente, queremos que si A transmite el número 5, la predicción de B sea el número 5. 




[^1]: En realidad el área de Wernicke y el área de Broca están conectadas por el fascículo arqueado {% cite Neil2012 %}.
[^2]: Esto aplica en modelos supervisados, en los que conocemos el valor que debería predecir el modelo para cada valor de entrada. Existen otros tipos de algoritmos (no supervisados, por ejemplo), en los que esto no se cumple y la función de _loss_ adquiere otras formas.

{% bibliography --cited %}